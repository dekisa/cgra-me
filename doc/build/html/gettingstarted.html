
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Getting Started &#8212; CGRA-ME 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="userguide.html" />
    <link rel="prev" title="Welcome to CGRA-ME’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<span id="gettingstarted-label"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="7%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Package</th>
<th class="head">Version</th>
<th class="head">Note</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>gcc</strong></td>
<td>&gt;=4.9.0</td>
<td>If you want to build llvm with gcc too, please follow llvm’s <a class="reference external" href="http://llvm.org/docs/GettingStarted.html#software">requirement</a> for gcc.</td>
</tr>
<tr class="row-odd"><td><strong>clang</strong></td>
<td>&gt;=3.8.0</td>
<td>Tested with various versions up to v6.0.0 .</td>
</tr>
<tr class="row-even"><td><strong>llvm</strong></td>
<td>&gt;=3.8.0</td>
<td>Tested with various versions up to v6.0.0 .</td>
</tr>
<tr class="row-odd"><td><strong>cmake</strong></td>
<td>&gt;=3.1.0</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td>&gt;=3.0.0</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>Gurobi Optimizer</strong></td>
<td>v7.0.2 or v7.5.1</td>
<td>Not required, but it is the main supported optimizer. We provide a SCIP implementation as well, but SCIP is much slower. Only free with academic license, but there is free trial.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installation">
<span id="installation-label"></span><h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Download the source code package from download page</li>
<li>Create a directory with your preferred name <code class="docutils literal notranslate"><span class="pre">&lt;PROJ_DIR&gt;</span></code></li>
<li>Extract the source code package in <code class="docutils literal notranslate"><span class="pre">&lt;PROJ_DIR&gt;</span></code> directory</li>
<li>Extract Gurobi library package in <code class="docutils literal notranslate"><span class="pre">&lt;PROJ_DIR&gt;</span></code></li>
<li>Go to <a class="reference external" href="http://www.gurobi.com/index">Gurobi website</a> to register and request a license, also download the Gurobi library</li>
<li>In bin subdirectory of Gurobi directory run <code class="docutils literal notranslate"><span class="pre">./grbgetkey</span> <span class="pre">&lt;key-you-obtained&gt;</span></code> to activate your Gurobi</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>If you are building llvm from source, make sure you put the build or install directory in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> environment variable.</li>
<li>There is a <a class="reference external" href="https://bugs.llvm.org/show_bug.cgi?id=23352">known</a> <a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/llvm/+bug/1387011">problem</a>
with the llvm-dev packages on many Ubuntu versions, where CMake fails to find parts of LLVM.
Building from source will work, or you can manually change some files in /usr. See <a class="reference internal" href="#install-troubleshoot-label"><span class="std std-ref">Troubleshooting</span></a></li>
</ul>
</div>
<ol class="arabic simple" start="7">
<li>$ <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">&lt;PROJ_DIR&gt;\cgra-me-uoft</span> <span class="pre">&amp;&amp;</span> <span class="pre">make</span></code></li>
</ol>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Reference the <a class="reference internal" href="userguide.html#cmake-build-label"><span class="std std-ref">CMake Build</span></a> guide if you want to use the complete feature, this is only a Makefile wrapper to CMake.</p>
</div>
<p>See <a class="reference internal" href="#install-troubleshoot-label"><span class="std std-ref">Troubleshooting</span></a> if you encountered any problem in installation process.</p>
</div>
<div class="section" id="environment-setup">
<h2>Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h2>
<p>There is a script <code class="docutils literal notranslate"><span class="pre">cgra-me-uoft/cgrame_env</span></code> that when <em>run</em> (not intended to be <code class="docutils literal notranslate"><span class="pre">source</span></code>’d) will
drop you into another instance of your <code class="docutils literal notranslate"><span class="pre">$SHELL</span></code> with
several convenient and essential environment variables set, including:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">PATH</span></code> will be augmented so that the most important
CGRA-ME binaries and scripts can be invoked with out explicit paths.</li>
<li><code class="docutils literal notranslate"><span class="pre">CGRA_MAPPER</span></code> will have the name of the mapper executable,
with the expectation that it will be resolved against the above modified path.</li>
<li>Several other variables related to file locations.</li>
</ul>
</div>
<div class="section" id="running-benchmarks">
<h2>Running Benchmarks<a class="headerlink" href="#running-benchmarks" title="Permalink to this headline">¶</a></h2>
<p>With the above installation and environment setup complete,
you can now try out the software on some of the included benchmarks and architectures (covered here)
and then move on to making your own (covered elsewhere).</p>
<div class="section" id="bulk-benchmark-runs">
<h3>Bulk Benchmark Runs<a class="headerlink" href="#bulk-benchmark-runs" title="Permalink to this headline">¶</a></h3>
<p>The script <code class="docutils literal notranslate"><span class="pre">cgra-me-uoft/benchmarks/experiment_runner</span></code> was created to make this fairly easy.
It is decently configurable and may be the simplest way to run experiments when using a single computer.
Configuration is done via a python file (specified by <code class="docutils literal notranslate"><span class="pre">-f</span></code>, though it has a default) and
it can run experiments in parallel (<code class="docutils literal notranslate"><span class="pre">-j</span></code> option).
For more documentation, and specifically documentation about the configuration input,
we direct you to run it with the <code class="docutils literal notranslate"><span class="pre">--help</span></code> option.</p>
<p>There is a configuration file example included as a starting point,
so if you just want to run the software, simply:</p>
<ol class="arabic simple">
<li>$ <code class="docutils literal notranslate"><span class="pre">cd</span>&#160; <span class="pre">cgra-me-uoft/benchmarks</span></code></li>
<li>$ <code class="docutils literal notranslate"><span class="pre">./experiment_runner</span></code></li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>This will take a while to finish, especially if parallelism is not enabled</li>
</ul>
</div>
</div>
<div class="section" id="individual-benchmark-running">
<h3>Individual Benchmark Running<a class="headerlink" href="#individual-benchmark-running" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">experiment_runner</span></code> script is (of course) capable of running exactly one experiment,
but it is useful to know some details if you plan on making your own,
or want to get to know the software better.</p>
<div class="section" id="generate-a-dfg">
<h4>Generate A DFG<a class="headerlink" href="#generate-a-dfg" title="Permalink to this headline">¶</a></h4>
<p>The first step is to generate a DFG (Data Flow Graph).
A DFG is a representation of a computation kernel that captures the logical movement of data from inputs though operations to outputs.
We’ll use one of the included benchmarks as an example.</p>
<ol class="arabic simple">
<li>$ <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">cgra-me-uoft/benchmarks/microbench/sum</span></code></li>
<li>$ <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">start</span> <span class="pre">from</span> <span class="pre">scratch</span></code></li>
<li>$ <code class="docutils literal notranslate"><span class="pre">ls</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">see</span> <span class="pre">what</span> <span class="pre">files</span> <span class="pre">are</span> <span class="pre">present</span> <span class="pre">before</span></code></li>
<li>$ <code class="docutils literal notranslate"><span class="pre">make</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">compile</span> <span class="pre">with</span> <span class="pre">clang,</span> <span class="pre">optimize,</span> <span class="pre">and</span> <span class="pre">emit</span> <span class="pre">the</span> <span class="pre">DFG</span></code></li>
<li>$ <code class="docutils literal notranslate"><span class="pre">ls</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">note</span> <span class="pre">graph_loop.dot</span> <span class="pre">was</span> <span class="pre">created</span></code></li>
</ol>
<p>This will generate several files, the most important of which is <code class="docutils literal notranslate"><span class="pre">graph_loop.dot</span></code> which holds the DFG
that resulted from the processing of the loop in the C file.
The format used is the classic ‘dot’ format and so can be viewed with several programs, for example <code class="docutils literal notranslate"><span class="pre">xdot</span></code>.
More details about how this step works can be found at <a class="reference internal" href="userguide.html#dfg-generation-label"><span class="std std-ref">Loop DFG Generation</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If LLVM was not installed, a pre-generated set of DFGs translated from the C benchmarks are distributed with the framework.
They can be found within the individual benchmark directories as <code class="docutils literal notranslate"><span class="pre">cgra-me-uoft/benchmarks/microbench/*/pre-gen-*.dot</span></code>.
To use them with <code class="docutils literal notranslate"><span class="pre">experiment_runner</span></code>, simply <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">pre-gen-graph_loop.dot</span> <span class="pre">graph_loop.dot</span></code> in each experiment directory you would like to use.</p>
</div>
</div>
<div class="section" id="mapping">
<h4>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h4>
<p>This is the process of taking a DFG and a CGRA architecture and
finally mapping the computation kernel onto the CGRA.
We will use one of the included architectures for demonstration.
After building the benchmark, now run this:</p>
<ol class="arabic simple">
<li>$ <code class="docutils literal notranslate"><span class="pre">&quot;$CGRA_MAPPER&quot;</span> <span class="pre">--II</span> <span class="pre">2</span> <span class="pre">-g</span> <span class="pre">graph_loop.dot</span> <span class="pre">--xml</span> <span class="pre">&quot;$CGRA_ME_ROOTDIR/arch/simple/archfiles/adres-no-torroid.xml&quot;</span></code></li>
</ol>
<p>If you looked into the <code class="docutils literal notranslate"><span class="pre">experiment_runner</span></code>’s help message, or investigate the Makefiles, you may wish to know that an equivalent way to run this would be to do:</p>
<ol class="arabic simple">
<li>$ <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">run_mapper</span> <span class="pre">&quot;CGRA_ARCH_ARGS=--xml</span> <span class="pre">$CGRA_ME_ROOTDIR/arch/simple/archfiles/adres-no-torroid.xml&quot;</span> <span class="pre">'CGRA_MAPPER_ARGS=--II</span> <span class="pre">2'</span></code></li>
</ol>
<p>Now if everything is setup correctly, you should see the mapper running, and it should complete in less than a minute.
We are mapping a benchmark that does sum over an array,
we are using an architecture similar to ADRES,
the architecture is using our default parameters of a four-by-four functional unit array,
and we are specifying that there are two contexts to context-switch between.</p>
<p>As a side note, this will use our default Integer Linear Programming-based mapping technique,
as opposed to our Simulated Annealing based one –
a choice which can be overridden with the <code class="docutils literal notranslate"><span class="pre">--mapper</span></code> option.
Run <code class="docutils literal notranslate"><span class="pre">$CGRA_MAPPER</span> <span class="pre">--help</span></code> for more details.</p>
</div>
</div>
</div>
<div class="section" id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Permalink to this headline">¶</a></h2>
<p>After a successful mapping, the <code class="docutils literal notranslate"><span class="pre">$CGRA_ME_ROOTDIR/output</span></code> directory is created.
Opening the <code class="docutils literal notranslate"><span class="pre">CGRA.html</span></code> document will show visualization of the MRRG nodes within the CGRA as well as the mapped nodes.
The top navigation bar shows tabs for multiple contexts of the CGRA.
Yellow nodes represent unused resources.
Teal nodes represent inputs or outputs of cross-context elements such as registers.
Blue nodes are composite nodes in the hierarchy.
Double-clicking on these nodes descends into the hierarchy.
Selecting and right-clicking on any node within the expanded hierarchy will collapse the node back into the composite node.
Red nodes represent used resources. Hovering over these nodes will inform the user within a tool-tip the part of the mapped DFG used that resource.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This is only a getting started guide to CGRA-ME, there are many other features, you can read the <a class="reference internal" href="userguide.html#userguide-label"><span class="std std-ref">User Guide</span></a> if you want to know more about them.</p>
</div>
<div class="section" id="troubleshooting">
<span id="install-troubleshoot-label"></span><h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="i-have-cmake-error-about-cannot-find-llvm-package">
<h3>I have cmake error about cannot find llvm package<a class="headerlink" href="#i-have-cmake-error-about-cannot-find-llvm-package" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Using apt-get: to fix the <a class="reference external" href="https://bugs.llvm.org/show_bug.cgi?id=23352">known</a> <a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/llvm/+bug/1387011">problem</a>,
we have provided some <code class="docutils literal notranslate"><span class="pre">.cmake</span></code> files in <code class="docutils literal notranslate"><span class="pre">cgra-me-uoft/doc/ubuntu-llvm-fix</span></code>. <strong>Intended for 16.04.</strong>
Copy these files to to <code class="docutils literal notranslate"><span class="pre">/usr/share/llvm-3.8/cmake</span></code> and make this symbolic link:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ln</span> <span class="pre">-s</span> <span class="pre">/usr/lib/x86_64-linux-gnu/libLLVM-3.8.so.1</span> <span class="pre">/usr/lib/llvm-3.8/lib/libLLVM-3.8.so.1</span></code>.</p>
</div></blockquote>
<p>Inspired by <a class="reference external" href="https://stackoverflow.com/a/44311146/2256231">a stack overflow answer</a>.</p>
</li>
<li><p class="first">Using apt-get: the package manager could mess up stuff sometimes, please check if you have any of the following directory in you <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>: <code class="docutils literal notranslate"><span class="pre">/usr/</span></code> or <code class="docutils literal notranslate"><span class="pre">/usr/bin/</span></code> or <code class="docutils literal notranslate"><span class="pre">/usr/sbin/</span></code>.
If you don’t see any of the above add <code class="docutils literal notranslate"><span class="pre">/usr/</span></code> to your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>, then try build again</p>
</li>
<li><p class="first">Build from llvm source: try to add <code class="docutils literal notranslate"><span class="pre">&lt;LLVM_DIR&gt;/build/</span></code> to your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>, then try build again</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the above did not help you, it might be that you have a existing llvm installed and it is tricking the package searcher from cmake. Reference the user guide and run cmake with the argument <code class="docutils literal notranslate"><span class="pre">-DCMAKE_PREFIX_PATH=&lt;path/to/your/llvm&gt;</span></code> to override the default llvm cmake file.</p>
</div>
<p>Send us an e-mail if you have any other problem!</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CGRA-ME</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-setup">Environment Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-benchmarks">Running Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#xml-user-guide">XML User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#c-api-user-guide">C++ API User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitation.html">Limitation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to CGRA-ME’s documentation!</a></li>
      <li>Next: <a href="userguide.html" title="next chapter">User Guide</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, CGRA-ME.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/gettingstarted.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>